import{a as L,K as T,L as F}from "./el-button-DUtZPU__.js";import{A as q,B as $,C as A,D as G,F as J,E as W,d as H,e as z,v as P}from "./Warning-IbXW8GI0.js";import{_ as j}from "./pageContainer-KVv8sQhj.js";import"./el-checkbox-C7N1_de6.js";import{d as K}from "./el-overlay-C4KiuAn2.js";import{E as Q}from "./el-drawer-Dxoc2mS7.js";import{E as X,a as Y}from "./el-form-item-DOpUR8ga.js";import{E as Z}from "./el-input-B5OuMNxW.js";import{E as x,a as k}from "./el-select-cHFXdczq.js";import{h as b,i as O,o as y,b as g,w as a,a as U,M as D,V as I,s as M,_ as ee,j as t,k as h,P as te,u as C}from "./index-DG5wITwl.js";import{E as B}from "./el-message-CH_Y3fQd.js";import"./isEqual-B-US3FdK.js";const le={__name:"MetricNamesSelect",props:{modelValue:{type:[Number,String]},type:{type:String},width:{type:String}},emits:["update:modelValue"],setup(_, {emit:v}){const r=_,i=v,s=b([]);console.log(r.type);const d=async()=>{const V=await q(r.type);s.value=JSON.parse(V.data.data),console.log(s.value)};return d(),O(()=>r.type,()=>{d()}),(V, f)=>{const l=x,n=k;return y(),g(n,{style:M({width:_.width}),modelValue:_.modelValue,"onUpdate:modelValue":f[0]||(f[0]= m=>i("update:modelValue",m))},{default:a(()=>[(y(!0),U(D,null,I(s.value,(m, u)=>(y(),g(l,{key:u,label:m,value:m},null,8,["label","value"]))),128))]),_:1},8,["style","modelValue"])}}},ae={__name:"FilterSelect",props:{modelValue:{type:[Number,String]},type:{type:String},metric:{type:String},width:{type:String}},emits:["update:modelValue"],setup(_, {emit:v}){const r=_,i=v,s=b([]);console.log(r.type);const d=async()=>{const V=await $(r.type,r.metric);s.value=JSON.parse(V.data.data).name,console.log(s.value)};return O([()=>r.type,()=>r.metric],()=>{d()}),d(),(V, f)=>{const l=x,n=k;return y(),g(n,{style:M({width:_.width}),modelValue:_.modelValue,"onUpdate:modelValue":f[0]||(f[0]= m=>i("update:modelValue",m))},{default:a(()=>[(y(!0),U(D,null,I(s.value,(m, u)=>(y(),g(l,{key:u,label:m,value:m},null,8,["label","value"]))),128))]),_:1},8,["style","modelValue"])}}},oe={__name:"OwnWarningEdit",emits:["success"],setup(_, {expose:v,emit:r}){const i=b(!1),s=r,d={type:"BMC",alertName:"",metricName:"",expr:"",severity:"",timeDuration:"",description:"",filters:""},f={type:[{required:!0,message:"请输入type",trigger:"blur"}],alertName:[{required:!0}],metricName:[{required:!0}],expr:[{required:!0},{validator:(u, e, c)=>{/^(>|<|=)\s\d+$/.test(e)?c():c(new Error('Invalid format. It should be like "> 40"'))},trigger:"blur"}],severity:[{required:!0}],description:[{required:!0}],filters:[{required:!0}]},l=b({...d}),n=async()=>{i.value=!0,l.value={...d}},m=async()=>{const u=new FormData;for(let e in l.value)e==="filters"?u.append(e,JSON.stringify({name:l.value[e]})):u.append(e,l.value[e]);await A(u),B.success("添加成功"),i.value=!1,s("success","add")};return v({open:n}),(u, e)=>{const c=Z,p=X,E=x,w=k,N=L,S=Y,R=Q;return y(),g(R,{modelValue:i.value,"onUpdate:modelValue":e[9]||(e[9]= o=>i.value=o),title:"添加错误",direction:"rtl",size:"50%"},{default:a(()=>[t(S,{model:l.value,ref:"formRef",rules:f,"label-width":"100px"},{default:a(()=>[t(p,{label:"硬件类型",prop:"type"},{default:a(()=>[t(c,{modelValue:l.value.type,"onUpdate:modelValue":e[0]||(e[0]= o=>l.value.type=o),placeholder:"请输入硬件类型"},null,8,["modelValue"])]),_:1}),t(p,{label:"告警名",prop:"alertName"},{default:a(()=>[t(c,{modelValue:l.value.alertName,"onUpdate:modelValue":e[1]||(e[1]= o=>l.value.alertName=o),placeholder:"请输入告警名"},null,8,["modelValue"])]),_:1}),t(p,{label:"metric",prop:"metricName"},{default:a(()=>[t(le,{modelValue:l.value.metricName,"onUpdate:modelValue":e[2]||(e[2]= o=>l.value.metricName=o),type:l.value.type,width:"100%"},null,8,["modelValue","type"])]),_:1}),t(p,{label:"表达式",prop:"expr"},{default:a(()=>[t(c,{modelValue:l.value.expr,"onUpdate:modelValue":e[3]||(e[3]= o=>l.value.expr=o),placeholder:"请输入表达式"},null,8,["modelValue"])]),_:1}),t(p,{label:"告警严重度",prop:"severity"},{default:a(()=>[t(w,{modelValue:l.value.severity,"onUpdate:modelValue":e[4]||(e[4]= o=>l.value.severity=o),placeholder:"请选择告警严重程度"},{default:a(()=>[t(E,{label:"NOTE",value:"NOTE"}),t(E,{label:"LOW",value:"LOW"}),t(E,{label:"HIGH",value:"HIGH"}),t(E,{label:"CRITICAL",value:"CRITICAL"})]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"持续时间",prop:"timeDuration"},{default:a(()=>[t(c,{modelValue:l.value.timeDuration,"onUpdate:modelValue":e[5]||(e[5]= o=>l.value.timeDuration=o),placeholder:"请输入持续时间"},null,8,["modelValue"])]),_:1}),t(p,{label:"说明",prop:"description"},{default:a(()=>[t(c,{modelValue:l.value.description,"onUpdate:modelValue":e[6]||(e[6]= o=>l.value.description=o),placeholder:"请输入说明"},null,8,["modelValue"])]),_:1}),t(p,{label:"过滤器",prop:"filters"},{default:a(()=>[t(ae,{modelValue:l.value.filters,"onUpdate:modelValue":e[7]||(e[7]= o=>l.value.filters=o),type:l.value.type,metric:l.value.metricName,width:"100%"},null,8,["modelValue","type","metric"])]),_:1}),t(p,null,{default:a(()=>[t(N,{onClick:e[8]||(e[8]= o=>m()),typeName:"primary"},{default:a(()=>[h("添加")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},ne=ee(oe,[["__scopeId","data-v-573d0cf0"]]),Ve={__name:"UserOwnWarning",setup(_){const v=b(!1),r=b([]),i=b(),s=async()=>{v.value=!0;const n=await G();r.value=JSON.parse(n.data.data),console.log(JSON.parse(n.data.data)),v.value=!1};s();const d=()=>{i.value.open({})},V= n=>{i.value.open(n)},f=async n=>{await K.confirm("你确认删除该自定义警告规则吗？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}),await J({type:n.type,alert_name:n.alertName}),B({type:"success",message:"删除成功"}),s()},l= n=>{console.log(n),s()};return(n, m)=>{const u=L,e=W,c=H,p=z,E=j,w=P;return y(),g(E,{title:"自定义告警规则"},{extra:a(()=>[t(u,{onClick:d},{default:a(()=>[h("添加自定义告警规则")]),_:1})]),default:a(()=>[te((y(),g(p,{data:r.value,style:{width:"100%"}},{empty:a(()=>[t(c,{description:"没有数据"})]),default:a(()=>[t(e,{label:"警报名称",prop:"alertName"}),t(e,{label:"警报规则",prop:"alertRule"}),t(e,{label:"严重性",prop:"severity"}),t(e,{label:"概述",prop:"summary"}),t(e,{label:"时间长度",prop:"timeLength"}),t(e,{label:"类型",prop:"type"}),t(e,{label:"操作",width:"100"},{default:a(({row:N})=>[t(u,{icon:C(T),circle:"",plain:"",type:"primary",onClick: S=>V(N)},null,8,["icon","onClick"]),t(u,{icon:C(F),circle:"",plain:"",type:"danger",onClick: S=>f(N)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[w,v.value]]),t(ne,{ref_key:"machineEditRef",ref:i,onSuccess:l},null,512)]),_:1})}}};export{Ve as default};
