import{_ as A}from"./pageContainer-C66w4MDG.js";/* empty css             *//* empty css               *//* empty css                     *//* empty css                  *//* empty css                 */import{u as f,r as c,o as B,c as C,a,b as e,d as u,f as v,e as F,as as I,h as m,p as q,n as N,q as z,t as T,m as j,E as L,at as M,au as P,a3 as $,av as G,aw as H}from"./index-CTSderqS.js";/* empty css                */const J={class:"avatar-container"},K=v("span",{class:"avatar-overlay"},null,-1),le={__name:"UserProfile",setup(O){const{user:{username:g,nickname:w,email:b,id:E,avatar:y}}=f(),i=f(),l=c({username:g,nickname:w,email:b,id:E}),d=c(y||"https://i.pravatar.cc/300"),p=c(),U={nickname:[{required:!0,message:"请输入用户昵称",trigger:"blur"},{pattern:/^\S{2,10}$/,message:"昵称必须是2-10位的非空字符串",trigger:"blur"}],email:[{required:!0,message:"请输入用户邮箱",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}]},V=async()=>{await p.value.validate()&&(await I(l.value),await i.getUser(),m.success("修改成功"))},k=async s=>{const t=new FileReader;return t.onload=async o=>{d.value=o.target.result;const r=new FormData;r.append("avatar",s.raw);try{await h(r),m.success("头像更换成功"),await i.getUser()}catch{m.error("头像更换失败，请重试")}},t.readAsDataURL(s.raw),!1},h=async s=>{};return(s,t)=>{const o=q,r=N,_=z,S=T,x=j,D=L,R=A;return B(),C(R,{title:"基本资料"},{default:a(()=>[e(D,{justify:"center",align:"middle"},{default:a(()=>[e(x,{span:12,md:8},{default:a(()=>[e(u(M),{shadow:"hover",class:"user-card"},{default:a(()=>[v("div",J,[e(u(P),{class:"avatar-uploader","show-file-list":!1,"before-upload":k,accept:"image/*"},{default:a(()=>[e(u($),{size:"100",src:d.value,class:"user-avatar"},null,8,["src"]),e(u(G),{class:"item",effect:"dark",content:"点击更换头像",placement:"bottom"},{default:a(()=>[K]),_:1})]),_:1})]),e(u(H)),e(S,{model:l.value,rules:U,ref_key:"formRef",ref:p,"label-width":"100px",size:"large",class:"user-form"},{default:a(()=>[e(r,{label:"登录名称"},{default:a(()=>[e(o,{modelValue:l.value.username,"onUpdate:modelValue":t[0]||(t[0]=n=>l.value.username=n),disabled:""},null,8,["modelValue"])]),_:1}),e(r,{label:"用户昵称",prop:"nickname"},{default:a(()=>[e(o,{modelValue:l.value.nickname,"onUpdate:modelValue":t[1]||(t[1]=n=>l.value.nickname=n),placeholder:"请输入您的昵称"},null,8,["modelValue"])]),_:1}),e(r,{label:"用户邮箱",prop:"email"},{default:a(()=>[e(o,{modelValue:l.value.email,"onUpdate:modelValue":t[2]||(t[2]=n=>l.value.email=n),placeholder:"请输入您的邮箱"},null,8,["modelValue"])]),_:1}),e(r,null,{default:a(()=>[e(_,{type:"primary",onClick:V,style:{width:"100%"}},{default:a(()=>[F("提交修改")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})]),_:1})}}};export{le as default};
