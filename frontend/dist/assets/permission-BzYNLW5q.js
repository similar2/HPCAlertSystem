/* empty css             *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                 *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                     *//* empty css               *//* empty css                  */import{_ as I,u as k,r as N,j as U,o as p,H as B,f as D,b as a,a as s,c as h,K as c,h as l,M as g,q as v,ai as _,ac as E,e as r,L as S,z as q,A as T,ag as M,aI as $,p as R,n as A,t as j}from"./index-CTSderqS.js";import{f as F,c as Q,a as V,u as z,d as H}from"./permission-DR1YJoLX.js";const K=i=>(q("data-v-8c553232"),i=i(),T(),i),L={class:"background-container"},O={class:"app-container"},G=K(()=>D("h1",{class:"page-title"},"权限列表",-1)),J={class:"button-panel"},W={class:"button-container"},X={data(){return{permissions:[],searchResult:null,isSearching:!1,errorMessage:"",showCreateDialog:!1,showUpdateDialog:!1,newPermission:{menuCode:"",menuName:"",permissionCode:"",permissionName:"",requiredPermission:""},updateData:{id:null,menuCode:"",menuName:"",permissionName:"",requiredPermission:""}}},methods:{loadPermissions(){F().then(i=>{i&&i.data&&Array.isArray(i.data.data)?this.permissions=i.data.data:this.errorMessage="权限数据格式不正确"}).catch(()=>{this.errorMessage="获取权限数据失败"})},openCreateDialog(){this.resetNewPermissionData(),this.showCreateDialog=!0},resetNewPermissionData(){this.newPermission={menuCode:"",menuName:"",permissionName:"",requiredPermission:""}},submitCreatePermission(){if(!this.newPermission.menuCode||!this.newPermission.permissionCode||!this.newPermission.menuName||!this.newPermission.permissionName||!this.newPermission.requiredPermission){l.error("请填写所有字段");return}Q(this.newPermission).then(()=>{l.success("权限创建成功"),this.showCreateDialog=!1,this.loadPermissions()}).catch(()=>{l.error("权限创建失败")})},promptUpdatePermission(){g.prompt("请输入要更新的权限ID","更新权限",{confirmButtonText:"下一步",cancelButtonText:"取消",inputPattern:/^[0-9]+$/,inputErrorMessage:"请输入有效的数字ID"}).then(({value:i})=>{this.fetchPermissionDetails(i)}).catch(()=>{l.info("已取消更新")})},fetchPermissionDetails(i){V(i).then(n=>{n.data&&n.data.data?(this.updateData={...n.data.data},this.showUpdateDialog=!0):l.error("权限未找到")}).catch(()=>{l.error("根据ID查询权限失败")})},submitUpdatePermission(){z(this.updateData.id,this.updateData).then(()=>{l.success("权限更新成功"),this.showUpdateDialog=!1,this.loadPermissions()}).catch(()=>{l.error("权限更新失败")})},promptDeletePermission(){g.prompt("请输入要删除的权限ID","删除权限",{confirmButtonText:"删除",cancelButtonText:"取消",inputPattern:/^[0-9]+$/,inputErrorMessage:"请输入有效的数字ID"}).then(({value:i})=>{this.deletePermissionById(i)}).catch(()=>{l.info("已取消删除")})},deletePermissionById(i){g.confirm(`确认删除权限 ID 为 ${i} 的记录吗？`,"警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{H(i).then(()=>{l.success("权限删除成功"),this.loadPermissions()}).catch(()=>{l.error("权限删除失败")})}).catch(()=>{l.info("已取消删除")})},promptQueryById(){g.prompt("请输入查询的权限ID","查询权限",{confirmButtonText:"查询",cancelButtonText:"取消",inputPattern:/^[0-9]+$/,inputErrorMessage:"请输入有效的数字ID"}).then(({value:i})=>{this.queryById(i)}).catch(()=>{l.info("已取消查询")})},queryById(i){V(i).then(n=>{n.data&&n.data.data?(this.searchResult=n.data.data,this.isSearching=!0):l.error("权限未找到")}).catch(()=>{l.error("根据ID查询权限失败")})},resetSearch(){this.isSearching=!1,this.searchResult=null,this.loadPermissions()}},mounted(){this.loadPermissions()}},Y=Object.assign(X,{__name:"permission",setup(i){const n=k(),f=N([]);return U(n.user.value.id).then(e=>{console.log("permission by id : ",e.data.data),f.value=e.data.data,console.log("permissions: ",permissions.value)}).catch(e=>{console.error("获取权限失败: ",e)}),(e,o)=>{const m=v,P=M,y=$,b=_,d=R,u=A,w=j,C=E;return p(),B("div",L,[D("div",O,[G,D("div",J,[D("div",W,[a(m,{type:"primary",onClick:e.promptQueryById},{default:s(()=>[r("根据ID查询权限")]),_:1},8,["onClick"]),f.value.includes("role:update")?(p(),h(m,{key:0,type:"success",onClick:e.promptUpdatePermission},{default:s(()=>[r("更新权限")]),_:1},8,["onClick"])):c("",!0),f.value.includes("role:delete")?(p(),h(m,{key:1,type:"danger",onClick:e.promptDeletePermission},{default:s(()=>[r("删除权限")]),_:1},8,["onClick"])):c("",!0),f.value.includes("role:add")?(p(),h(m,{key:2,type:"primary",onClick:e.openCreateDialog},{default:s(()=>[r("新建权限")]),_:1},8,["onClick"])):c("",!0),e.isSearching?(p(),h(m,{key:3,type:"info",onClick:e.resetSearch},{default:s(()=>[r("返回")]),_:1},8,["onClick"])):c("",!0)])]),e.permissions.length||e.isSearching?(p(),h(b,{key:0,data:e.isSearching?[e.searchResult]:e.permissions,border:"",stripe:"",class:"custom-table"},{default:s(()=>[a(P,{prop:"id",label:"ID",width:"80",align:"center"}),a(P,{prop:"menuName",label:"菜单名称",align:"center"}),a(P,{prop:"permissionName",label:"权限名称",align:"center"}),a(P,{label:"是否必选",align:"center"},{default:s(t=>[a(y,{type:t.row.requiredPermission===1?"success":"info"},{default:s(()=>[r(S(t.row.requiredPermission===1?"是":"否"),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])):c("",!0)]),a(C,{title:"新建权限",modelValue:e.showCreateDialog,"onUpdate:modelValue":o[6]||(o[6]=t=>e.showCreateDialog=t),width:"400px"},{footer:s(()=>[a(m,{onClick:o[5]||(o[5]=t=>e.showCreateDialog=!1)},{default:s(()=>[r("取消")]),_:1}),a(m,{type:"primary",onClick:e.submitCreatePermission},{default:s(()=>[r("确定")]),_:1},8,["onClick"])]),default:s(()=>[a(w,{model:e.newPermission},{default:s(()=>[a(u,{label:"菜单代码"},{default:s(()=>[a(d,{modelValue:e.newPermission.menuCode,"onUpdate:modelValue":o[0]||(o[0]=t=>e.newPermission.menuCode=t),placeholder:"输入菜单代码"},null,8,["modelValue"])]),_:1}),a(u,{label:"菜单名称"},{default:s(()=>[a(d,{modelValue:e.newPermission.menuName,"onUpdate:modelValue":o[1]||(o[1]=t=>e.newPermission.menuName=t),placeholder:"输入菜单名称"},null,8,["modelValue"])]),_:1}),a(u,{label:"权限代码"},{default:s(()=>[a(d,{modelValue:e.newPermission.permissionCode,"onUpdate:modelValue":o[2]||(o[2]=t=>e.newPermission.permissionCode=t),placeholder:"输入权限代码"},null,8,["modelValue"])]),_:1}),a(u,{label:"权限名称"},{default:s(()=>[a(d,{modelValue:e.newPermission.permissionName,"onUpdate:modelValue":o[3]||(o[3]=t=>e.newPermission.permissionName=t),placeholder:"输入权限名称"},null,8,["modelValue"])]),_:1}),a(u,{label:"是否必选"},{default:s(()=>[a(d,{modelValue:e.newPermission.requiredPermission,"onUpdate:modelValue":o[4]||(o[4]=t=>e.newPermission.requiredPermission=t),placeholder:"输入是否必选 (1/2)"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(C,{title:"更新权限信息",modelValue:e.showUpdateDialog,"onUpdate:modelValue":o[12]||(o[12]=t=>e.showUpdateDialog=t),width:"400px"},{footer:s(()=>[a(m,{onClick:o[11]||(o[11]=t=>e.showUpdateDialog=!1)},{default:s(()=>[r("取消")]),_:1}),a(m,{type:"primary",onClick:e.submitUpdatePermission},{default:s(()=>[r("确定")]),_:1},8,["onClick"])]),default:s(()=>[a(w,{model:e.updateData},{default:s(()=>[a(u,{label:"菜单代码"},{default:s(()=>[a(d,{modelValue:e.updateData.menuCode,"onUpdate:modelValue":o[7]||(o[7]=t=>e.updateData.menuCode=t),placeholder:"输入菜单代码"},null,8,["modelValue"])]),_:1}),a(u,{label:"菜单名称"},{default:s(()=>[a(d,{modelValue:e.updateData.menuName,"onUpdate:modelValue":o[8]||(o[8]=t=>e.updateData.menuName=t),placeholder:"输入菜单名称"},null,8,["modelValue"])]),_:1}),a(u,{label:"权限名称"},{default:s(()=>[a(d,{modelValue:e.updateData.permissionName,"onUpdate:modelValue":o[9]||(o[9]=t=>e.updateData.permissionName=t),placeholder:"输入权限名称"},null,8,["modelValue"])]),_:1}),a(u,{label:"是否必选"},{default:s(()=>[a(d,{modelValue:e.updateData.requiredPermission,"onUpdate:modelValue":o[10]||(o[10]=t=>e.updateData.requiredPermission=t),placeholder:"输入是否必选 (1/0)"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),de=I(Y,[["__scopeId","data-v-8c553232"]]);export{de as default};
